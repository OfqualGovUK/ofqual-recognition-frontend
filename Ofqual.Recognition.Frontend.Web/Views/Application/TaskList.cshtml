@using Ofqual.Recognition.Frontend.Core.Enums
@using Ofqual.Recognition.Frontend.Core.Models
@using Ofqual.Recognition.Frontend.Core.Extensions
@model List<TaskItemStatusSection>

<div class="govuk-grid-row">
    <div class="govuk-grid-column-full">

        <h1 class="govuk-heading-xl">
            Apply to have your qualifications regulated
        </h1>

        @if (Model != null && Model.Any())
        {
            @foreach (var taskSection in Model)
            {
                <h2 class="govuk-heading-m">
                    @taskSection.SectionName
                </h2>
                <ul class="govuk-task-list">
                    @foreach (var task in taskSection.Tasks)
                    {
                        <li class="govuk-task-list__item govuk-task-list__item--with-link">
                            <div class="govuk-task-list__name-and-hint">
                                @if (task.Status == TaskStatusEnum.CannotStartYet)
                                {
                                    <div>@task.TaskName</div>
                                    <div id="review-submit-@task.TaskId-hint" class="govuk-task-list__hint">
                                        You must complete all sections first
                                    </div>
                                }
                                else
                                {
                                    <a class="govuk-link govuk-task-list__link"
                                    href="@(task.TaskName == "Review application" ?
                                        $"/application/review-your-application-answers?taskId={task.TaskId}" :
                                        $"/application/review-your-task-answers?taskId={task.TaskId}")"
                                    aria-describedby="task-@task.TaskId-status">
                                        @task.TaskName
                                    </a>
                                }
                            </div>
                            <div class="govuk-task-list__status" id="task-@task.TaskId-status">
                                @if (task.Status != TaskStatusEnum.Completed)
                                {
                                    <strong class="govuk-tag @task.Status.GetTagClass()">
                                        @task.Status.GetDisplayName()
                                    </strong>
                                } else {
                                    @task.Status.GetDisplayName()
                                }
                            </div>
                        </li>
                    }
                </ul>
            }
        }
        else
        {
            <p class="govuk-body">No tasks available.</p>
        }
    </div>
</div>